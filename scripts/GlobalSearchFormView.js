"use strict";var GlobalSearchFormView=Backbone.View.extend({el:$("body"),events:{"submit #js-searchForm,#js-footSearch":"clearAndSubmit","click .header__mobile-nav-button":"toggleMobileMenu","click .header__mobile-search-button":"toggleMobileSearch","click .js-global-header-logo":"clearQueryManager"},navOpenState:!0,searchOpenState:!0,clearAndSubmit:function(e){this.model.set({q:$(e.currentTarget).find("input[name=q]").val()},{silent:!0}),this.model.trigger("change:q"),e.preventDefault()},setAttrs:function(e,t,a){t&&a&&(!1===e?(t.classList.add("is-closed"),t.classList.remove("is-open"),a.setAttribute("aria-expanded",!1)):(t.classList.add("is-open"),t.classList.remove("is-closed"),a.setAttribute("aria-expanded",!0)))},watchHeaderWidth:function(r){return function(e){var t=document.querySelector(".header__search"),a=document.querySelector(".header__mobile-search-button"),s=document.querySelector(".header__nav"),n=document.querySelector(".header__mobile-nav-button");e.matches?(r.navOpenState=!0,r.searchOpenState=!0):(r.navOpenState=!1,r.searchOpenState=!1),t&&r.setAttrs(r.searchOpenState,t,a),r.setAttrs(r.navOpenState,s,n)}},toggleMobileMenu:function(e){var t=document.querySelector(".header__nav");!0===this.navOpenState?this.navOpenState=!1:this.navOpenState=!0,this.setAttrs(this.navOpenState,t,e.currentTarget)},toggleMobileSearch:function(e){var t=document.querySelector(".header__search");!0===this.searchOpenState?this.searchOpenState=!1:this.searchOpenState=!0,this.setAttrs(this.searchOpenState,t,e.currentTarget)},clearQueryManager:function(){_.isEmpty(this.model.attributes)||this.model.clear({silent:!0})},initialize:function(){this.listenTo(this.model,"change:q",this.render),$(document).on("pjax:beforeReplace","#js-pageContent",this.pjax_beforeReplace);var e=window.matchMedia("(min-width: 650px)");this.watchHeaderWidth(this)(e),e.addListener(this.watchHeaderWidth(this))},closeMenu:function(){$(".js-global-header__search").addClass("global-header__search"),$(".js-global-header__search").removeClass("global-header__search--selected"),$(".js-global-header__mobile-links").addClass("global-header__mobile-links"),$(".js-global-header__mobile-links").removeClass("global-header__mobile-links--selected")},render:function(){if(this.model.has("q")){var e=this.model.get("q");this.model.clear({silent:!0}),this.model.set({q:e},{silent:!0}),$.pjax({url:$("#js-searchForm").attr("action"),container:"#js-pageContent",data:this.model.toJSON()})}else this.model.clear({silent:!0}),$.pjax({url:$("#js-searchForm").attr("action"),container:"#js-pageContent",data:{q:""}});var t;_.each($("#js-searchForm, #js-footerSearch"),(t=this.model,function(e){$("input[name=q][form="+$(e).attr("id")+"]").val(t.get("q"))}))},changeWidth:function(e){void 0!==this.facetForm&&this.facetForm.changeWidth(e),void 0!==this.carousel&&this.carousel.changeWidth(e),void 0!==this.complexCarousel&&this.complexCarousel.changeWidth(e)},pjax_beforeReplace:function(){0<$("#js-mosaicContainer").length&&$("#js-collectionPagination").children().length&&$("#js-mosaicContainer").infiniteScroll("destroy")},pjax_end:function(){this.closeMenu()}});